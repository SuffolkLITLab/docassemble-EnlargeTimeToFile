---
include:
  - docassemble.MAVirtualCourt:basic-questions.yml
---
code: |
  interview_short_title = "Ask the court for a Motion for Enlargement of Time to File Brief"
---
id: interview order
mandatory: True
code: |
  appeals_basic_questions_intro_screen
  info_screen
  #trial_court_docket_number
  appeals_court_docket_number
  plaintiff_name
  defendant_name
  if user_role == 'APPELLANT':
    if not docketing_statement: 
       docketing_warning
  if user_role == 'APPELLANT':
    enlargement_choice  
  current_due_date
  deadline_request
  previous_request_count
  reason_additional_time
  display_reason
  users[0].name.first
  users[0].address.address
  users[0].phone_number
  service_choice 
  service_information 
  service_date  
  if has_evidence_ready_to_upload:
    review_exhibits
  preview_screen
  basic_questions_signature_flow
  users[0].signature
  download
--- 
id: info screen
question: |
  Motion for Enlargement of Time to File Brief
subquestion: |
  If for some reason you cannot meet the prescribed deadline in which to serve and file your brief and appendix, or a status report, you may file a motion with the Appeals Court asking for more time.
  
  The motion must set forth the reasons for the requested extension, provide a date certain by which the brief will be filed, and must be accompanied by a certificate of service which lists the name of the document being served, the date of service, the manner of service (e.g., first class mail, in hand service, or e-service through eFileMA.com), and the names and addresses of all parties being served.
  
  A copy of the motion must be served on all other parties to the appeal.
continue button field: info_screen
---
#id: department and division 
#question: | 
#  Enter the **trial court** department and division in which your case was heard 
#fields:
#  - Trial Court: courts[0]
#    datatype: object
#    choices: macourts.filter_courts(["appeals_court"])
--- 
# id: trial court docket 
# question: | 
#   What is the **trial court** docket number for your case?
# fields:
#   - 'Docket number': trial_court_docket_number
---
id: appeals docket number 
question: |
  What is the **Appeals Court** docket number for your case?
fields:
  - 'Appeals Court docket number': appeals_court_docket_number
---
id: plaintiffs name
question: |
  List the plaintiff or plaintiffs in your trial court case 
subquestion: |
  Include yourself, if you are a plaintiff. If there are more than one plaintiffs, you can enter more than one name.
fields: 
  - 'Plaintiff(s) name': plaintiff_name
---
id: defendants names
question: |
  List all of the defendant or defendants in your trial court case
subquestion: |
  Include yourself, if you are a defendant.  If there are more than one defendants, you can enter more than one name.
fields: 
  - 'Defendant(s) name': defendant_name
---
id: user role
question: |
  Are you an appellant or appellee ?
subquestion: | 
  An appellant is a party who is appealing regardless of their party designation in the trial court.
  
  An appellee is a party who is not appealing and intends to respond to the appellant's appeal.
fields: 
  - no label: user_role 
    input type: radio 
    choices: 
      - Appellant: APPELLANT 
      - Appellee: APPELLEE
---
id: docketing statement
question: |
  Have you filed your docketing statement?
subquestion: | 
  Each appellant or cross-appellant, other than a self-represented litigant who is incarcerated, is required to submit the  docketing statement within fourteen days of issuance of the notice of entry of the appeal. 
yesno: docketing_statement
---
id: warning
event: docketing_warning
question: |
  If you have not filed the docketing statement, the court can deny any motion to enlarge time to file a brief until the docketing statement is filed
subquestion: |
  Each appellant or cross-appellant, other than a self-represented litigant who is incarcerated, is required to submit the attached docketing statement within fourteen days of issuance of the notice of entry of the appeal
  
  Access the Docketing Statement for [civil cases](https://www.mass.gov/doc/civil-docketing-statement-updated-10-28-19/download)  and  [criminal](https://www.mass.gov/doc/criminal-docketing-statement-updated-10-28-19/download) 
buttons:
  - Exit: exit
    url: https://massaccess.suffolklitlab.org/
  - Restart: restart
---
id: type of request
question: |
  Are you seeking an enlargement of time to file your principal brief and record appendix or your reply brief? 
fields: 
  - no label: enlargement_choice 
    input type: radio 
    choices: 
    - 'Principal brief and record appendix': principal
    - 'Reply brief': reply
---
id: date request 
question: |
  Provide the date that you are **asking your deadline be extended to**
subquestion: |
  The enlargement sought should not exceed ${ current_due_date.plus(days=120) }, 120 days from your current due date. 
fields:
  - Requested deadline: deadline_request
    datatype: date
    min: ${ current_due_date.today() } 
    max: ${ current_due_date.plus(days=120) } 
#help: 
#  label: Check for state holdiays
#  heading: Check for state holdiays
#  content: |
#    If a legal holiday falls on a Saturday, all offices under the jurisdiction of any department of state government will be open to the public for business on the Friday immediately before any Saturday holiday. 
#    If a legal holiday falls on a Sunday, the holiday will be observed on the following Monday. 
#    
#    [Massachusetts Legal Holidays](https://www.sec.state.ma.us/cis/cishol/holidx.htm)
#    
#    [Trial Court legal holidays](https://www.mass.gov/service-details/trial-court-legal-holidays)
---
id: signature date  
question: |
  When are you going to file this form?
subquestion: |
  We automatically answer “today” for you, below. You can change the date. 
fields:
  - 'Date': penalties_perjury_date 
    datatype: date
    default: ${today().format("MM-dd-yyyy")}
---
id: previous request count
question: |
  Enter the number of previous requests that you have submitted to enlarge the deadline for filing **this particular brief**
fields: 
  - 'Number of previous requests': previous_request_count
    datatype: integer
    default: 0
    min: 0
    max: 99
---
id: current due date
question: |
  Enter the **current due date** for your brief
fields:
  - 'Current due date': current_due_date
    datatype: date
---
id: describe reason for time 
question: |
  Describe the reasons that you require additional time to file your brief 
fields: 
  - no label: reason_additional_time
    datatype: checkboxes
    choices:
      - I am sick or had a medical emergency: I am sick or had a medical issue
      - Someone close to me was sick or has died : Someone close to me was sick or has died
      - I have a childcare issue: I have a childcare issue
      - I have a calendaring issue : I have a calendaring issue
      - I need more time to work on my brief: I need more time to work on my brief
    none of the above: False
    required: False
  - Other: has_other_reason
    datatype: yesnowide
  - Other Reason: other_reason_for_extension
    input type: area 
    show if: has_other_reason    
#validation code: |
#  if(not showifdef('I am sick or had a medical emergency') and \
#     (not showifdef('Someone close to me was sick or has died')) and \
#     (not showifdef('I have a childcare issue')) and \
#     (not showifdef('I have a calendaring issue')) and \
#     (not showifdef('I need more time to work on my brief')) and \
#     (not showifdef('Other Reason'))):
#    validation_error(word("You need to provide at least one reason you require additional time to file your brief."))
---
id: show user description
field: display_reason 
question: | 
  Here is what you've told the court about why you need more time.  
subquestion: |
  ${ (reason_additional_time).true_values() } ${ showifdef('other_reason_for_extension') }
---
id: your name
question:  |
  What is your name?
fields:
  - First Name: users[0].name.first
  - Middle Name: users[0].name.middle
    required: False
  - Last Name: users[0].name.last
  - Suffix: users[0].name.suffix
    code: |
      name_suffix()
    required: False  
---
id: your contact information
question: |
  What is your contact information?
subquestion: |
  The court needs to be able to reach you.
  
  Include at least **one** way to reach you other than by mail.
fields:  
  - Mobile number: users[0].mobile_number
    required: False
  - Other phone number: users[0].phone_number
    required: False
  - Email address: users[0].email    
    datatype: email
    required: False
  - Other ways to reach you: users[0].other_contact_method
    input type: area
    required: False
    help: |
      If you do not have a phone number or email the court can use, provide
      specific contact instructions. For example, use a friend's phone number.
      But the friend must be someone you can rely on to tell you the court is
      trying to reach you.
validation code: |
  if (not showifdef('users[0].phone_number') and \
      (not showifdef('users[0].mobile_number')) and \
      (not showifdef('users[0].email')) and \
      (not showifdef('users[0].other_contact_method'))):
    validation_error(word("You need to provide at least one contact method."))
help: |
  The court **must** be able to reach you. So you have to give them some way to do this.
  
  Some forms allow you to tell the court you need to keep your address, phone,
  and email confidential, so that only court staff can see this information. 

---
id: signature block 
question: |
  Name, physical address, email address, telephone number, date of completion
--- 
id: service 
question: |
  Select the method of delivery that you have used or will use to provide the required copies of the motion, memorandum and supporting materials to the other party(s) attorney(s).
subquestion: |
  If the other party(s) do not have an attorney, you are required to serve a copy on the self-represented party.
field: service_choice 
dropdown: 
  - eFile and serve (efilema.com): eFile and servie (efilema.com)
  - Email: email
  - Mail: mail
  - Hand delivery: hand delivery
---
id: name and address for service 
question: |
  List the name and address or email address of each attorney or self-represented party that you have served or will serve with copies of your motion, memorandum and supporting materials
subquestion: | 
   If you are serving more than one attorney or party, you may list more than one in the space provided
fields: 
  - no label: service_information 
    input type: area
---
id: date of service 
question: |
  Select the date on which you have made or will make service
fields: 
  - Date: service_date 
    datatype: date
---
id: persons signature
generic object: Individual
question: |
  ${x}, sign under the penalties of perjury
signature: x.signature
under: |
  ${x}
progress: 99  
---
id: signature choice
decoration: file-signature
question: |
  Sign your court forms
subquestion: |
  Your forms are almost ready. You need to sign them first.
  
  Use the mouse or touchpad on your computer or
  sign with your finger on your phone. 
   
  You can send the forms to someone else to sign if you choose the "phone" option.
field: signature_choice
buttons:  
  - Sign on my phone: phone
    image: mobile-alt
  - Sign on this computer: this device
    image: desktop
continue button field: saw_signature_choice
script: |
  <script>
    $(".da-field-buttons > div > .btn-da-custom").last().after("<br>")
    $(".da-field-buttons > div > .btn-da-custom").first().before("<br>")
  </script>
--- 
#id: upload 
#question: |
#  Upload any relevant documents in support of your request for relief, including any necessary affidavits
#subquestion: |
#  It is not required that you provide any additional documents
#fields:
#  - no label: exhibit_document  
#    datatype: file
#    required: False
---
#id: download
#event: download
#question: |
#  Your forms are ready to download.
#subquestion: |
#  ${ motion_attachment["final"] } 
#attachment code: motion_attachment["final"]
---
code: | 
  form_to_sign = motion_attachment["preview"]
---
objects:
  - motion_attachment: DADict
---
id: final attachment
attachment:
  - name: Motion for Enlargement of Time
    variable name: motion_attachment[i]
    filename: Motion_for_Enlargement_of_Time
    docx template file: Motion_for_Enlargement_of_Time.docx
---
id: review before signature
need: form_to_sign
continue button field: preview_screen
question: |
  Nearly finished
subquestion: |
  You are almost done! Please click on the form below. It will open in a new window so you can review it and make sure it is correct.
  
  Don't forget to come back to this page to click to the final step of signing and sending the form to the court. 
  
   ${ form_to_sign }
progress: 95
attachment code: motion_attachment["preview"]
---
id: download form
event: download
decoration: file-download
question: |
  % if not defined('email_success') or not email_success:
  Review, Download, and Send Form
  % else:
  Form delivered
  % endif
subquestion: |
  % if not defined('email_success') or not email_success:
  Thank you ${users[0]}. Your form is ready to send to the court. **It is not
  delivered until you complete the delivery process below.**
  1. Click the preview image below to open the form in a new window. Correct any errors using the "Make changes" button below.
  1. Download and save or print a copy of this form for your 
  records.
  1. Click the "Submit to ${courts[0]}" button to send it to the court. 
  1. You will have a chance to add instructions to the clerk and see the cover page before final delivery.
  % else:
  If you do not hear from the court in 1 business day, call the   Appeals Court Clerk's Office: 617-921-4443 
  
  The Appeals Court Clerk's Office is open:  
  Monday - Friday  
  8:30am - 4:30pm
  % endif
  
  ${ form_to_file_no_cover }  
  
  ${action_button_html(url_action('review_all_sections'), icon='edit', label=word("Make changes"))}
  
  % if not defined('email_success') or not email_success:
    ${ action_button_html( url_action('form_delivery_complete'), id_tag="submitToCourt", label="Submit to " + str(courts[0].name), icon=send_icon, size="md", color="primary")}
    
  Or download/email below:
  % else:
    Your email has already been delivered to ${courts[0]}
  % for file in final_form_to_file:
  [:file-download: ${ file.info.get("filename") }](${file.url_for()})
  % endfor 
  % endif
progress: 100
section: download
attachment code: motion_attachment["final"]
---
need:
  - comments_to_clerk
  - package_version_number
id: ready to email
question: |
  Final Review With Cover Page
subquestion: |
  
  Below is your ${comma_and_list(download_titles)} document with the 
  cover page that we will deliver to ${courts[0]}.
  
  Click "Back" if you need to make any changes.  
  Click "Send to court" to deliver it.
  
  Here is what the clerk at ${courts} will get:
  % for file in final_form_to_file:
  ${ file }  
  [:file-download: ${ file.info.get("filename") }](${file.url_for()})  
  % endfor 
  
  % if found_email:
  We will deliver it securely. Please allow up to 15 minutes for the email to
  arrive.
  % else:
  There was a problem delivering this to the ${courts[0]}. We couldn't
  locate the contact information for this court.
  % endif
 
  Press below to deliver the form.
fields:
  - Send me a copy: should_cc_user
    datatype: yesno
  - Email address: cc_email
    datatype: email
    show if: should_cc_user
    default: ${users[0].email if defined('users[0].email') else ''}
continue button field: ready_to_email
continue button label: Send to court
---
objects:
  - exhibits: DAFileList.using(auto_gather=False, gathered=True)
---
id: record appendix
question: |
  Would you like to provide documents in support of your request for an extension of time to file your brief? 
subquestion: |
  You do not need to disclose specific sensitive personal information in supporting materials. For example, if a medical condition has prevented you from working on the brief, you do not need to provide medical records.  
fields:
  - Do you have any documents to share with the judge?: has_evidence
    datatype: yesnoradio
  - Are you ready to take a photo or upload them now?: has_evidence_ready_to_upload
    datatype: yesnoradio
    show if: has_evidence
  - note: |
      Okay. It is not required that you provide proof. Tap next. 
    show if: 
      variable: has_evidence_ready_to_upload      
      is: False
  - note: |
      Take a picture of each document you want to upload, or get the files ready to
      upload on your computer or phone.
      
      When you're ready, use the upload area below.
    show if: has_evidence_ready_to_upload
  - Tap "browse" and choose all of the photos you want to upload at once. You can edit or add additional documents on the next screen.: exhibits
    datatype: files
    show if: has_evidence_ready_to_upload
    accept: |
      "image/*, image/png,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf,.pdf"
---
table: exhibits.table
rows: exhibits
allow reordering: True
columns:
  - File name: showifdef(row_item.attr_name('filename'))
  - Thumbnail: row_item.show(width="100px")  
delete buttons: True
---
id: add additional document
question: |
  Exhibit document ${i+1}  
fields:
  - no label: exhibits[i]
    datatype: file
    accept: |
      "image/*, image/png,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf,.pdf"   
validation code: |
  # Upload field creates a DAFileList
  # We want it to be a plain DAFile instead
  if isinstance(exhibits[i], DAFileList):
    temp_name = exhibits[i].instanceName
    exhibits[i] = next(iter(exhibits[i]))
    # Make sure the "instanceName" shows the correct position in the list,
    # instead of showing a nested DAFileList's instanceName
    exhibits[i].instanceName = temp_name
---
id: review exhibits
question: |
  Review your exhibits
subquestion: |
  Look at the exhibits below. If you want to change the order, use the arrows
  to move an exhibit up or down in the list. Click "delete" or "add another"
  to change which exhibits you send to the court.
  
  ${ exhibits.table }
  
  ${exhibits.add_action() }
continue button field: review_exhibits
---
code: |
  if has_evidence_ready_to_upload:
    combined_motion = pdf_concatenate(motion_attachment["final"], exhibits, filename="motion_for_enlargement_of_time.pdf")
  else:
    combined_motion = motion_attachment["final"]
---
code: |
  if has_evidence_ready_to_upload:
    form_to_sign = pdf_concatenate(motion_attachment["preview"], exhibits, filename="motion_for_enlargement_of_time.pdf")
  else:
    form_to_sign = pdf_concatenate(motion_attachment["preview"], filename="motion_for_enlargement_of_time.pdf")
---
code: |
  form_to_file_no_cover = combined_motion
---